name: ci-for-demo

on:
  push:
    branches:
      - "main"
      - "feature/PPAC-89"
    release:
      types:
        - "published"

jobs:
  trigger-workflow:
    runs-on: ubuntu-latest
    steps:
      - name: Docker meta
        id: meta
        uses: docker/metadata-action@v4
        with:
          images: |
            name=prefix,enable=true
          tags: |
            type=ref,event=branch,suffix=_${{ github.run_number }}
            type=semver,pattern={{version}}
      - id: print
        env:
          BUILD_TAG: ${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}
          TEST: ${{ secrets.TEST }}
        run: |
          echo ${{ steps.meta.outputs.tags }}
          echo ${TEST}
          echo ${{ fromJSON(steps.meta.outputs.json).labels['org.opencontainers.image.version'] }}
          echo ${BUILD_ARG}
